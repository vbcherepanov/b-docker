# ============================================================================
# BITRIX DOCKER - LOCAL DEVELOPMENT ENVIRONMENT
# Локальная разработка на рабочей станции разработчика
# ============================================================================

# ============================================================================
# ОСНОВНЫЕ НАСТРОЙКИ
# ============================================================================
COMPOSE_PROJECT_NAME=bitrix
ENVIRONMENT=local
DEBUG=1
TZ=Europe/Moscow

# Домен для локальной разработки
DOMAIN=bitrix.local
EMAIL=dev@bitrix.local

# ============================================================================
# PHP НАСТРОЙКИ
# ============================================================================
PHP_VERSION=8.3

# PHP-FPM Pool настройки (для local - меньше процессов)
PHP_FPM_PM=dynamic
PHP_FPM_MAX_CHILDREN=20
PHP_FPM_START_SERVERS=3
PHP_FPM_MIN_SPARE_SERVERS=2
PHP_FPM_MAX_SPARE_SERVERS=10

# PHP лимиты (для разработки - больше времени на отладку)
PHP_MEMORY_LIMIT=512M
PHP_UPLOAD_MAX_FILESIZE=128M
PHP_POST_MAX_SIZE=128M
PHP_MAX_EXECUTION_TIME=600
PHP_MAX_INPUT_TIME=600

# OPcache (для local - disable для актуального кода)
PHP_OPCACHE_ENABLE=0
PHP_OPCACHE_MEMORY=128
PHP_OPCACHE_MAX_FILES=10000

# Security (для local - session.cookie_secure = Off т.к. нет HTTPS)
SESSION_COOKIE_SECURE=Off

# ============================================================================
# ПОЛЬЗОВАТЕЛЬ И ГРУППА (важно для прав доступа)
# ============================================================================
# macOS/Linux: используйте свой UID/GID (узнать: id -u и id -g)
# Windows: оставьте 1000
UID=1000
GID=1000
UGN=bitrix

# ============================================================================
# СЕТЕВЫЕ НАСТРОЙКИ
# ============================================================================
DOCKER_SUBNET=172.20.0.0/16

# Порты для локальной разработки
HTTP_PORT=80
HTTPS_PORT=443

# ============================================================================
# MYSQL - БАЗА ДАННЫХ
# ============================================================================
DB_HOST=mysql
DB_PORT=3306
DB_NAME=bitrix_local
DB_USERNAME=bitrix
DB_PASSWORD=bitrix_local_password
DB_ROOT_PASSWORD=root_local_password

# MySQL настройки (для local - меньше ресурсов)
MYSQL_INNODB_BUFFER_POOL_SIZE=512M
MYSQL_MAX_CONNECTIONS=100
MYSQL_MEMORY_LIMIT=1G
MYSQL_MEMORY_RESERVATION=512M

# ============================================================================
# REDIS - КЭШИРОВАНИЕ
# ============================================================================
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=redis_local_password
REDIS_MAX_MEMORY=256mb

# ============================================================================
# MEMCACHED - ДОПОЛНИТЕЛЬНОЕ КЭШИРОВАНИЕ
# ============================================================================
MEMCACHED_HOST=memcached
MEMCACHED_PORT=11211
MEMCACHED_MEMORY_LIMIT=128
MEMCACHED_THREADS=2
MEMCACHED_CONN_LIMIT=512

# ============================================================================
# RABBITMQ - ОЧЕРЕДИ (опционально)
# ============================================================================
RABBITMQ_HOST=amqp
RABBIT_PORT=5672
RABBIT_UI_PORT=15672
RABBIT_COOKIE=local_rabbitmq_cookie_change_me
RABBITMQ_DEFAULT_USER=rabbitmq
RABBITMQ_DEFAULT_PASS=rabbitmq_local_password
RABBITMQ_DEFAULT_VHOST=/

# ============================================================================
# MAILHOG - ПЕРЕХВАТ ПОЧТЫ
# ============================================================================
MAILHOG_PORT=1025
MAILHOG_WEB_PORT=8025

# ============================================================================
# SSL НАСТРОЙКИ
# ============================================================================
# 0 = без SSL, 1 = self-signed, 2 = Let's Encrypt
SSL=1

# ============================================================================
# NGINX КОНФИГУРАЦИЯ
# ============================================================================
MAIL_CONFIG=1
RABBIT_CONFIG=0
DOLLAR=$

# ============================================================================
# BITRIX НАСТРОЙКИ
# ============================================================================
BITRIX_VM_VER=9.0.0

# ============================================================================
# МОНИТОРИНГ И ЛОГИРОВАНИЕ
# ============================================================================
GRAFANA_PORT=3000
GRAFANA_ADMIN_PASSWORD=admin

PROMETHEUS_PORT=9090

# ============================================================================
# БЭКАПЫ
# ============================================================================
BACKUP_SCHEDULE_DB=0 3 * * *
BACKUP_SCHEDULE_FILES=0 4 * * *
BACKUP_RETENTION_DAYS=3

# ============================================================================
# PORTAINER AGENT
# ============================================================================
PORTAINER_PORT=9001
PORTAINER_AGENT_SECRET=local_portainer_secret_change_me

# ============================================================================
# ДОПОЛНИТЕЛЬНЫЕ НАСТРОЙКИ
# ============================================================================
# Режим работы Docker Compose
# Для local используем профили: local
COMPOSE_PROFILES=local,monitoring
